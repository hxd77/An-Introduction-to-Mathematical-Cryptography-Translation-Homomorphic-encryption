## 2.8 中国剩余定理

中国剩余定理描述了联立线性同余方程组的解。最简单的情况是由两个同余式组成的方程组，
$$
x\equiv a({\mathrm{mod}}m)\quad\mathrm{and}\quad x\equiv b({\mathrm{mod}}n)\tag{2.3}
$$
当$\gcd(m，n)=1$时，中国剩余定理表明存在一个模 $mn$ 的唯一解。这类问题的首个有记载的实例出现在公元3世纪末或4世纪初的一部中国数学著作中。它实际上处理的是更难的三个联立同余式问题。

中国剩余定理及其推广在数论和数学的其他领域有许多应用。在2.9节中，我们将看到它如何被用于解决离散对数问题的某些实例。我们从一个求解两个联立同余式的例子开始。在阅读这个例子时，请注意，它不仅仅是一个关于解存在的抽象陈述。我们所描述的方法实际上是一种能够让我们找到解的算法。

Example 2.23. 我们寻找一个整数 $x$，使其同时满足这两个同余式。
$$
x\equiv1({\mathrm{mod}}5)\quad\mathrm{and}\quad x\equiv9({\mathrm{mod}}11).\tag{2.4}
$$
第一个同余式告诉我们$x\equiv1({\mathrm{mod}}5)$，因此第一个同余式的全部解是整数的集合
$$
x=1+5y,\quad y\in\mathbb{Z}.\tag{2.5}
$$
将（2.5）代入（2.4）中的第二个同余式，得到
$$
1+5y\equiv9({\mathrm{mod}}11),\quad\mathrm{and~hence}\quad5y\equiv8({\mathrm{mod}}11).\tag{2.6}
$$
我们通过将（2.6）式两边乘以 $5$ 模 $11$ 的逆元来求解 $y$。这个逆元存在，因为 $5$ 和 $11$ 的最大公约数是 $1$ ，并且可以使用命题1.13中描述的方法来计算（另见注记1.15）。不过，在这种情况下，模数非常小，我们可以通过试错法找到它：$5$ 乘以 $9$ 等于 $45$ ，而 $45$ 模 $11$ 的结果是 $1$ 。

无论如何，将（2.6）式的两边都乘以 $9$ ，得到
$$
\begin{array}{cc}y\equiv9\cdot8\equiv72\equiv6&({\mathrm{mod}}11).\end{array}
$$
最后，将 $y$ 的这个值代入（2.5）中，就得到了该解。
$$
x=1+5\cdot6=31
$$
对于原始问题。

例2.23中概述的步骤可用于推导两个联立同余式解的一般公式（见练习2.20），但更好的做法是学习这种方法，而非死记公式。这一点尤为重要，因为中国剩余定理适用于任意多个联立同余式组成的方程组。

**Theorem 2.24 (中国剩余定理)** 设$m_{1},m_{2},\ldots,m_{k}$是一组两两互质的整数。这意味着
$$
\gcd(m_{i},m_{j})=1\quad for\ all\ i\neq j.
$$
设$a_1,a_2,\ldots,a_k$为任意整数。那么这个联立同余方程组
$$
x\equiv a_1({\mathrm{mod}}m_1),\quad x\equiv a_2({\mathrm{mod}}m_2),\quad\ldots,\quad x\equiv a_k({\mathrm{mod}}m_k)\tag{2.7}
$$
有一个解 $x = c$。此外，如果 $x = c $ 和 $x = c^{\prime}$都是解，那么
$$
c\equiv c^{\prime}({\mathrm{mod}}m_1m_2\cdots m_k).\tag{2.8}
$$
Proof. 假设对于某个 $i$ 值，我们已经成功找到了满足前 $i$ 个联立同余式的解 $x = c_i$，
$$
x\equiv a_1({\mathrm{mod}}m_1),\quad x\equiv a_2({\mathrm{mod}}m_2),\quad\ldots,\quad x\equiv a_i({\mathrm{mod}}m_i)\tag{2.9}
$$
例如，如果 $i=1$ ，那么 $c_1=a_1$是可行的。我们将解释如何再找到一个同余式的解，
$$
x\equiv a_1({\mathrm{mod}}m_1),\quad x\equiv a_2({\mathrm{mod}}m_2),\quad\ldots,\quad x\equiv a_{i+1}({\mathrm{mod}}m_{i+1})
$$
思路是寻找一种具有如下形式的解决方案
$$
\begin{array}{c}x=c_i+m_1m_2\cdots m_iy.\end{array}
$$
注意到 $x$ 的这个值仍然满足所有的同余式（2.9），因此我们只需选择 $y$ ，使得它也满足 $x\equiv a_{i+1}({\mathrm{mod}}m_{i+1})$。换句话说，我们需要找到一个满足以下条件的 $y$ 值：
$$
c_i+m_1m_2\cdots m_iy\equiv a_{i+1}({\mathrm{mod}}m_{i+1}).
$$
命题1.13（b）以及$\gcd(m_{i+1},m_{1}m_{2}\cdots m_{i})=1$这一事实表明，我们总是可以做到这一点。这就完成了解的存在性的证明。我们把证明不同的解满足（2.8）这一任务留给你；参见练习2.21。

中国剩余定理（定理2.24）的证明很容易转化为一种求解联立同余方程组的算法。一个例子就足以说明这种一般方法。

Example 2.25. 我们求解这三个联立同余式
$$
x\equiv2({\mathrm{mod}}3),\quad x\equiv3({\mathrm{mod}}7),\quad x\equiv4({\mathrm{mod}}16).\tag{2.10}
$$
中国剩余定理表明，存在一个模 $336$ 的唯一解，因为 $336 = 3·7·16 $。我们从第一个同余式 $x\equiv2({\mathrm{mod}}3).$的解 $x = 2$ 开始。我们用它来构造通解 $x = 2 + 3y$，并将其代入第二个同余式，得到
$$
2+3y\equiv3({\mathrm{mod}}7).
$$
这简化为$3y\equiv1({\mathrm{mod}}7)$，然后我们将两边都乘以 $5$（因为 $5$ 是 $3$ 模 $7$ 的逆元），得到 $y\equiv5({\mathrm{mod}}7)$。这就给出了值
$$
x=2+3y=2+3\cdot5=17
$$
作为（2.10）中前两个同余式的一种解法。

前两个同余式的通解因此为$x = 17 + 21z$。我们将其代入第三个同余式，得到
$$
17+21z\equiv4({\mathrm{mod}}16).
$$
这简化为$5z\equiv3({\mathrm{mod}}16).$。我们乘以 $13$（它是 $5$ 模 $16$ 的逆元），得到
$$
z\equiv3\cdot13\equiv39\equiv7({\mathrm{mod}}16).
$$
最后，我们将其代入 $x = 17 + 21z $中以得到解。
$$
x=17+21\cdot7=164.
$$
所有其他的解都可以通过在这个特定的解上加上或减去 $336$ 的倍数得到。

### 2.8.1 解具有复合模数的同余式

通常，求解具有复合模数的同余式最简便的方法是，先求解若干个模为素数（或素数幂）的同余式，然后运用中国剩余定理将这些解组合起来。在本节中，我们通过讨论求模 $m$ 的平方根这一问题来阐释这一原理。事实证明，计算模为素数的平方根相对容易。实际上，对于模 $4$ 余 $3$ 的素数，求其平方根极其简单，如下述命题所示。

Proposition 2.26. 设 $p$ 是一个满足$p\equiv3({\mathrm{mod}}4)$的素数。设 $a$ 是一个整数，使得同余式$x^{2}\equiv a({\mathrm{mod}}p)$有解，也就是说，$a$ 在模 $p$ 下有平方根。那么
$$
b\equiv a^{(p+1)/4}({\mathrm{mod}}p)
$$
是一个解，即它满足$b^{2}\equiv a(\mathrm{mod}p).$。（注意：此公式仅在 $a$ 对模 $p$ 有平方根时才有效。在第3.9节中，我们将介绍一种有效的方法来判断哪些数对模 $p$ 有平方根。）

证明：设g是模p的一个原根。那么a等于g的某个幂，而a对模p有平方根这一事实意味着a是g的偶次幂，即a ≡ g²ᵏ（mod p）。（参见练习2.5。）现在我们来计算

Example 2.27.  $a=2201 $ 模质数 $p=4127$ 的一个平方根，即
$$
b\equiv a^{(p+1)/4}=2201^{4128/4}\equiv2201^{1032}\equiv3718({\mathrm{mod}}4127).
$$
为了证明 $a$ 在模 $4127$ 下确实有平方根，我们只需对 $b$ 进行平方，然后验证 $3718^2=13823524\equiv 2201(\mod 4127)$。

假设现在我们想要计算模 $m$ 的平方根，其中$m$不一定是质数。一种有效的方法是对 $m$ 进行因式分解，计算每个质（或质数幂）因子的模平方根，然后使用中国剩余定理组合这些解。一个例子可以清楚地说明这个思路。