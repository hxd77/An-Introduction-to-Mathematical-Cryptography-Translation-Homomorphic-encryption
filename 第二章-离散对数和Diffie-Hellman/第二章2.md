## 2.2 离散对数问题

离散对数问题是一个在许多场景中都会出现的数学问题，包括本节中所描述的模$p$版本，以及我们之后会在第6章学习的椭圆曲线版本。第一个公开发表的公钥构造由迪菲和赫尔曼提出，它基于有限域$\mathbb{F}_{p}$中的离散对数问题，这里需要回顾一下，$\mathbb{F}_{p}$是一个元素个数为质数的域（参见1.4节）。为方便起见，我们交替使用符号$\mathbb{F}_{p}$和$\mathbb{Z}/p\mathbb{Z}$来表示这个域，并且对于$\mathbb{F}_{p}$中的元素使用等式符号，对于$\mathbb{Z}/p\mathbb{Z}$中的元素使用同余符号（参见注1.23）。

设 $p$ 是一个（大的）素数。定理1.30告诉我们，存在一个原根 $g$ 。这意味着 $\mathbb{F}_{p}$ 中的每个非零元素都等于 $g$ 的某个幂。特别地，根据费马小定理（定理1.24），有 $g^{p-1}=1$ ，且 $g$ 的任何更小的正次幂都不等于 $1$ 。换句话说，元素的列表
$$
\begin{array}{c}1,g,g^2,g^3,\ldots,g^{p-2}\in\mathbb{F}_p^*\end{array}
$$
是按某种顺序排列的 $\mathbb{F}_p^*$ 中元素的完整列表。

**Definition.** 设 $g$ 是 $\mathbb{F}_{p}$ 的一个原根，$h$ 是 $\mathbb{F}_{p}$ 中的一个非零元素。离散对数问题（DLP）是指找到一个指数$x$，使得
$$
g^x\equiv h({\mathrm{mod}}p).
$$
数 $x$ 被称为 $h$ 以 $g$ 为底的离散对数，记为 $\log_g(h)$。

Remark 2.1. 离散对数的一个较旧术语是指数，记为 $index$。指数这一术语在数论中仍被广泛使用。当普通对数和离散对数存在混淆风险时，使用指数这一术语也很方便，例如，$\log_2$这个量在两种情况下都经常出现。

Remark 2.2. 离散对数问题是一个定义明确的问题，即找到一个整数指数 $x$，使得 $g^x = h$。然而，如果存在一个解，那么就会有无限多个解，因为费马小定理（定理1.24）告诉我们 $ g^{p-1}\equiv1({\mathrm{mod}}p)$ 。因此，如果 $x$ 是$g^x = h$ 的一个解，那么对于任意的 $k$ 值，$x + k(p−1)$ 也是一个解，因为
$$
g^{x+k(p-1)}=g^x\cdot(g^{p-1})^k\equiv h\cdot1^k\equiv h({\mathrm{mod}}p).
$$
因此，$\log_g(h)$的定义仅取决于加上或减去 $p−1 $ 的倍数。换句话说，$\log_g(h)$ 实际上是在模 $p−1$ 的意义下定义的。不难验证（练习2.3(a)），$\log_g$给出了一个良定义的函数。
$$
\log_g:\mathbb{F}_p^*\longrightarrow\frac{\mathbb{Z}}{(p-1)\mathbb{Z}}.\tag{2.1}
$$
有时，为了具体起见，我们将“那个”离散对数称为介于 $0$ 和 $ p−2$ 之间且满足同余式 $g^x\equiv h({\mathrm{mod}}p)$ 的整数 $x$。

Remark 2.3. 不难证明（参见练习2.3（b））
$$
\log_g(ab)=\log_g(a)+\log_g(b)\quad\mathrm{for\ all}\ a,b\in\mathbb{F}_p^*.
$$
![image-20251002200232940](https://raw.githubusercontent.com/hxd77/BlogImage/master/TyporaImage/20251002200233015.png)

因此，将 $\log_g $ 称为“对数”是合理的，因为它与通常的对数函数以相同的方式将乘法转换为加法。在数学术语中，离散对数$\log_g$是从 $\mathbb{F}_p^*$ 到 $\mathbb{Z}/(p-1)\mathbb{Z}.$ 的群同构。

>* $\mathbb{F}_p^*$ 是一个 **乘法群**，元素是 $1,2,\dots,p-1$。
>  
>* $\mathbb{Z}/(p-1)\mathbb{Z}$ 是模 $p-1$ 的 **加法群**，元素是 $\{0,1,\dots,p-2\}$。
>  
>* 离散对数 $\log_g$ 正好给出了一个同构：
>  
>    $$\log_g : \mathbb{F}_p^* \;\longrightarrow\; \mathbb{Z}/(p-1)\mathbb{Z},$$
>    
>    它把乘法对应到加法：
>    
>    $$\log_g(h_1 h_2) = \log_g(h_1) + \log_g(h_2).$$
>
>这就是所谓的 **群同构**：两个不同的群结构（一个是乘法群，一个是加法群），通过 $\log_g$ 完全等价。



Example 2.4. 数 $p=56509$ 是质数，并且可以验证 $g=2$ 是模 $p$ 的原根。那么我们该如何计算$h=38679 $ 的离散对数呢？唯一显而易见的方法是计算
$$
\begin{array}{ccccccc}2^2,&2^3,&2^4,&2^5,&2^6,&2^7,\ldots&({\mathrm{mod}}56509)\end{array}
$$
直到我们找到某个等于 $38679$ 的幂。手动计算这一点会很困难，但借助计算机，我们发现$\log_2(h)=11235$。你可以通过计算 $2^{11235}$ 对 $56509$ 取模，并检查结果是否等于 $38679$ 来验证这一点。

Remark 2.5. 必须强调的是，离散对数与定义在实数或复数上的连续对数几乎没有相似之处。不过，这一术语的使用仍然是合理的，因为在这两种情况下，指数运算的过程都被反转了——但模p的指数运算会随着指数的变化而呈现出非常不规则的变化，这与连续对数中指数运算的表现截然不同。即使粗略地看一下诸如表2.1中的数值表，也能明显发现模 $p$ 的指数运算具有看似随机的特性。在表2.1中，我们列出了素数 $p=941$ 和底数 $g=627$ 时的前几个幂以及前几个离散对数。图2.2中 $627^i$ 模 $941$ 的散点图也展示了这种看似随机的特性。

Remark 2.6. 我们对离散对数问题的陈述包含了底数 $g$ 是模 $p$ 的原根这一假设，但这并非绝对必要。一般来说，对于任意g∈Fₚ*和任意h∈Fₚ*，离散对数问题是指在存在这样的x的前提下，确定满足gˣ≡h（模p）的指数x。

**Definition.** 设 $G$ 是一个群，其群运算用符号 * 表示。$G$ 的离散对数问题是，对于给定的 $G$ 中的任意两个元素 $g$ 和 $ h$ ，确定一个整数 $x$，使得
$$
\underbrace{g\star g\star g\star\cdots\star g}_{x\mathrm{times}}=h.
$$
