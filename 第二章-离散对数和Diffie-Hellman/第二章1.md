# 第二章 离散对数和Diffie-Hellman

## 2.1 公钥加密的诞生

1976 年，惠特菲尔德・迪菲（Whitfield Diffie）和马丁・赫尔曼（Martin Hellman）发表了他们如今著名的论文，标题为《密码学的新方向》（“New Directions in Cryptography”）。在这篇论文中，他们阐述了公钥加密系统的概念，并为这一新兴领域做出了多项开创性贡献。不久前，拉尔夫・默克尔（Ralph Merkle）已独立提出了其中一个基本问题，并在伯克利（Berkeley）的一门计算机科学课上，为一个本科项目设计了一种公钥构造方法，但当时这一成果鲜为人知。默克尔的著作《通过不安全信道实现安全通信》（“Secure Communication over Insecure Channels”）于 1982 年问世。

然而，事实证明，公钥加密的概念最初是由詹姆斯・埃利斯（James Ellis）在英国政府通信总部（GCHQ）工作时发现的。埃利斯在 1969 年的研究成果被英国政府列为机密材料，直到 1997 年他去世后才被解密并公开。如今人们知晓，英国政府通信总部的另外两位研究人员 —— 马尔科姆・威廉姆森（Malcolm Williamson）和克利福德・科克斯（Clifford Cocks），分别早于迪菲、赫尔曼、里弗斯（Rivest）、沙米尔（Shamir）和阿德勒曼（Adleman）重新发现并公开传播这些算法之前，就已发现了迪菲 - 赫尔曼密钥交换算法和 RSA 公钥加密系统。想要了解更多关于公钥密码学的迷人历史，例如可参阅。

迪菲 - 赫尔曼的论文发表是一个极其重要的事件 —— 它确立了数学 / 计算机科学这一新兴领域的基本定义和目标，而这一领域的存在依赖于当时正兴起的数字计算机时代。事实上，他们的论文开篇就发出了行动的号召：

```
如今，我们正站在密码学革命的边缘。
```

一项原创性的或突破性的科学理念通常被称为具有革命性，但在这件事上，正如其作者们充分意识到的那样，“革命性” 一词还有另一层含义。在《新方向……》发表之前，美国的加密研究是国家安全局的专属领域，该领域的所有信息都属于机密。事实上，直到 20 世纪 90 年代中期，美国政府都将加密算法视为军需品，这意味着出口加密算法可被视为叛国罪而受到起诉。最终，政府意识到，试图阻止对抽象加密算法的自由公开讨论是徒劳的，而且限制国内使用高强度加密方法在法律上也站不住脚。然而，为了保持一定的控制权，政府继续限制 “机器可读” 的高安全性加密算法的出口。政府的目的是防止复杂的加密程序在全球范围内广泛传播到美国的潜在敌人手中，这一初衷值得称赞 ，但有两个难题导致政府的这一政策难以推行。

首先，光学扫描仪的存在使得 “机器可读” 和 “人类文本” 之间的界限变得十分模糊。为了抗议政府的这一政策，人们用一种名为 perl 的编程语言编写了三行版的 RSA 算法，并将其印在 T 恤和汽水罐上，从而使这些产品变成了军需品。理论上，穿着一件 “支持 RSA 算法” 的 T 恤从纽约飞往欧洲，穿这件 T 恤的人可能会被处以巨额罚款和 10 年监禁。更有趣（或者说更可怕，这取决于你的视角）的是，将 RSA 的 perl 代码纹在身上，会使人体变成不可出口的军需品！

其次，尽管这些以及其他更严肃的抗议和法律挑战产生了一定影响，但一个简单的现实最终使得政府的政策失去了意义。公钥算法相当简单，尽管以安全的方式实现它们需要一定的专业知识，但世界上到处都是优秀的数学家、计算机科学家和工程师。因此，政府对 “高强度加密技术” 出口的限制，只是催生了世界其他地区加密产业的发展。政府成功地将高强度加密技术的普及延缓了几年，但现在，任何人都可以花很少的钱购买到能实现完全安全通信的加密软件。

迪菲和赫尔曼在文献中的第一个重要贡献是定义了公钥密码系统（PKC）及其相关组件 —— 单向函数和陷门信息。**单向函数是一种可逆函数，它易于计算，但求其逆函数却很困难**。那么，“难以计算” 意味着什么呢？**直观地说，如果任何试图在 “合理” 时间内（例如，短于宇宙的年龄）计算逆函数的算法几乎必然会失败，那么这个函数就是难以计算的，而 “几乎必然” 这一表述必须从概率角度来定义**（关于 “难度” 更严格的定义，请参见 2.6 节）。

安全的公钥密码系统是利用具有陷门的单向函数构建的。陷门是一种辅助信息，借助它可以轻松计算出逆函数。图 2.1 对这一思想进行了说明，但必须强调的是，单向陷门函数的抽象概念与其实际构造之间存在着巨大的鸿沟。

![](https://raw.githubusercontent.com/hxd77/BlogImage/master/20250929204342747.png)

如1.7.6节所述，公钥（或非对称）密码系统的密钥由两部分组成，即私钥$k_{\mathrm{priv}}$和公钥$k_{\mathrm{pub}}$，在实际应用中，公钥$k_{\mathrm{pub}}$是通过对私钥$k_{\mathrm{priv}}$应用某种密钥生成算法计算得出的。对于每一对公钥/私钥（$k_{\mathrm{pub}}$，$k_{\mathrm{priv}}$），都有一个加密算法$e_{k_{\mathrm{pub}}}$和一个对应的解密算法$d_{k_{\mathrm{priv}}}$。与$k_{\mathrm{pub}}$对应的加密算法$e_{k_{\mathrm{pub}}}$是公开可知且易于计算的。同样，知道私钥$k_{\mathrm{priv}}$的人应该能轻松计算出解密算法$d_{k_{\mathrm{priv}}}$，但对于只知道公钥$k_{\mathrm{pub}}$的人来说，计算该解密算法应该是非常困难的。

有人说，私钥$k_{\mathrm{priv}}$是函数$e_{k_{\mathrm{pub}}}$的陷门信息，因为如果没有这一陷门信息，要计算$e_{k_{\mathrm{pub}}}$的反函数会非常困难，而有了陷门信息，计算反函数就会变得容易。需要注意的是，尤其是从$k_{\mathrm{priv}}$生成$k_{\mathrm{pub}}$所用到的函数，其逆运算一定很难进行，因为$k_{\mathrm{pub}}$是公开可知的，而$k_{\mathrm{priv}}$能实现高效解密。

得知尽管经过了多年的研究，人们仍然不知道单向函数是否存在，这可能会让人感到惊讶。事实上，证明单向函数的存在将同时解决著名的$\mathcal{P}=\mathcal{N}P$问题。人们已经提出了多种单向函数的候选方案，其中一些被现代公钥加密算法所采用。但必须强调的是，这些密码系统的安全性基于这样一种假设：对底层函数进行求逆（或者从公钥中找到私钥）是一个难题。

这种情况在某种程度上类似于物理学中的理论，这些理论会随着时间的推移而获得可信度，因为它们无法被证伪，并且能持续解释或催生有趣的现象。迪菲和赫尔曼在文献中对单向函数提出了一些建议，包括背包问题和模$q$指数运算，但他们并未给出公钥密码体制（PKC）的实例，主要是因为没有找到合适的陷门信息。不过，他们确实描述了一种公钥方法，通过该方法可以在不安全的信道上安全地共享某些信息。他们的这种方法现在被称为迪菲-赫尔曼密钥交换，其依据是离散对数问题（DLP）难以解决这一假设。我们将在2.2节讨论离散对数问题，然后在2.3节介绍迪菲-赫尔曼密钥交换。在他们的论文中，迪菲和赫尔曼还定义了多种密码分析攻击，并引入了数字签名和单向认证的重要概念，这些我们将在第4章和8.5节中进行讨论。

随着1976年文献的发表，一场发明实用公钥密码系统的竞赛拉开了帷幕。在两年内，两篇描述公钥密码系统的重要论文相继发表：里弗斯特、沙米尔和阿德曼提出的RSA方案，以及默克尔和赫尔曼提出的背包方案。在这两种方案中，只有RSA经受住了时间的考验，因为其背后基于的大整数分解这一难题在计算上仍然足够困难，使得RSA能够高效运行。相比之下，默克尔和赫尔曼的背包系统被证明在实际计算水平下是不安全的。然而，对背包系统的密码分析揭示了它与整数格理论中困难计算问题之间的重要联系，我们将在第7章中对此进行探讨。
