# The Learning with Errors Problem

在本次调查中，我们介绍了the Learning with Error（LWE）问题。讨论了其性质、难度以及密码学应用。

## 1. 介绍

近年来，由[Reg05]提出的The Learning with Errors（LWE）问题已成为密码学构造中的一个及其通用的基础。它之所以声明远扬，主要是因为它与最坏情况下的格问题是难解的前提下，所有基于它的密码学构造都是安全的。本综述的目的是介绍我们对这一问题理解的最新进展。尽管这里呈现的所有结果（除了附录 A 中的观察结果外）都已在文献中出现过，但我们试图让表述比原始论文中的更简洁一些。有关 LWE 及相关问题的更多信息，请参见一些最近关于格基密码学的综述 [MR08, Pei09b, Mic07, Reg06]。



### LWE.

LWE问题要求在给定关于秘密 $\mathrm{s}\in\mathbb{Z}_q^n$ 的一系列“近似”随机线性方程组的情况下，从中恢复出秘密$s$。例如，输入可能是
$$
\begin{aligned}14s_1+15s_2+5s_3+2s_4&\approx8({\mathrm{mod}}17)\\13s_1+14s_2+14s_3+6s_4&\approx16({\mathrm{mod}}17)\\6s_1+10s_2+13s_3+1s_4&\approx3({\mathrm{mod}}17)\\10s_1+4s_2+12s_3+16s_4&\approx12({\mathrm{mod}}17)\\9s_1+5s_2+9s_3+6s_4&\approx9({\mathrm{mod}}17)\\3s_1+6s_2+4s_3+5s_4&\approx16({\mathrm{mod}}17)\\&\mathrm{:}\\6s_1+7s_2+16s_3+2s_4&\approx3({\mathrm{mod}}17)\end{aligned}
$$
其中每个方程的误差在某个小的附加误差范围内（例如，$\pm1)$），而我们的目标是恢复$s$。（在这种情况下，答案是$s = (0,13,9,11)$。

如果不是因为这个错误，找到$s$会非常容易：大约有$n$个方程后，我们可以使用高斯消元法在多项式时间内恢复$s$。引入错误似乎使这个问题变得明显更加困难。例如，高斯消元算法会对$n$个方程进行线性组合，从而将误差放大到难以处理的程度，导致最终方程中基本上没有留下任何信息。

让我们更精确地定义这个问题。固定一个大小参数$n\ge 1$、一个模数$q \ge 2$，以及一个在$\mathbb{Z}_q$上的“误差”概率分布$\chi$。令$A_{\mathbf{s},\chi}$为 $\mathbb{Z}_{q}^{n}\times\mathbb{Z}_{q}$上的概率分布，它通过以下方式获得：随机均匀地选择一个向量$\mathbf{a}\in\mathbb{Z}_q^n$，根据分布$\chi$选择$e\in\mathbb{Z}_q$，然后输出$(\mathbf{a},\langle\mathbf{a},\mathbf{s}\rangle+e)$，其中加法在$\mathbb{Z}_q$中进行，即模$q$运算。我们说一个算法解决了具有模数$q$和误差分布的LWE问题，如果对于任意$\mathbf{s}\in\mathbb{Z}_q^n,$，给定任意数量的来自$A_{\mathbf{s},\chi}$的独立样本，该算法能（以高概率）输出$s$。我们注意到，LWE可以等价地看作是从随机线性码中解码的问题，或者看作是格上的随机有界距离解码问题。此外，我们注意到$q = 2$的特殊情况对应于著名的带噪声学习奇偶校验（LPN）问题。在这种情况下，误差分布可以仅由一个参数$\epsilon > 0$来指定，即误差概率（也就是取值为1的概率）。



### 参数. 

在所有应用以及整个本综述中，误差分布$\chi$被选为一个正态分布，该正态分布经四舍五入取最接近的整数（并对$q$取模约简），其标准差为$\mathrm{aq}$，通常取为$1/poly(n)$，其中$\mathrm{a}＞0$（见Figure 1）。事实上，正如我们稍后将要提及的，可以证明这种分布在某种意义上是“LWE完全的”。模数$q$通常取为$n$的多项式。选择指数级的模数$q$存在一个缺点，即会显著增加输入的大小（作为$n$的函数），从而使密码学应用的效率大大降低，但它也有一个优点，即该问题的困难性在某种程度上更容易理解；详情见下文。在大多数情况下，方程的数量似乎是无关紧要的。例如，已知的硬度结果本质上与其无关。这在一定程度上可以解释为，从给定的固定多项式数量的方程中，人们可以生成任意数量的额外方程，这些方程本质上与新方程一样好，只是误差分布略有恶化。这一性质在[GPV08, ACPS09]中得到了证明（另见[Lyu05]），并将在第2节中再次讨论。

![image-20250921234716060](https://cdn.jsdelivr.net/gh/hxd77/BlogImage/Blog/image-20250921234716060.png)

### 算法. 

解决LWE的一种简单方法是通过最大似然算法。为简单起见，假设 $q$ 是多项式，且误差分布如上所述是正态分布。那么，不难证明，在大约$O(n)$个方程之后，唯一能“近似满足”这些方程的$s$的赋值就是正确的那个方程。这可以通过一个基于切尔诺夫界和对所有$\mathbf{s}\in\mathbb{Z}_q^n$的联合界的标准论证来证明。这就产生了一种仅使用$O(n)$个样本、运行时间为$2^{O(nlogn)}$的算法。由此得出的一个推论是，LWE是“定义良好的”，也就是说，在方程数量为$\Omega(n)$的情况下，解$s$极有可能是唯一的。

另一种更为简单的算法如下：不断请求LWE样本，直到获得多项式级数量poly(n)的形如$s_1\approx\ldots$的方程（即一对$(\mathbf{a},b)$，其中$\mathbf{a}=(1,0,...,0)$），这时我们就能恢复出$s_1$的值。然后我们对所有的$s_i$重复此过程。出现这样一个方程的概率为$q^n$，这导致该算法需要$2^{O(nlogn)}$个方程，且运行时间与之相近。

一个更有趣的算法源自布鲁姆（Blum）、卡莱（Kalai）和沃瑟曼（Wasserman）的研究成果 [BKW03]，该算法仅需$2^{O(n)}$的样本量和时间复杂度。其核心是一种巧妙的思路：能在$2^{O(n)}$个方程中找到一个小规模的方程集合$S$（例如，规模为 $n$），使得集合中向量$a_i$的和为（举例来说）$(1,0,\dots,0)$。具体操作简要来说是：将 $n$ 个坐标划分为$\log n$个块，每个块的规模为$n/\log n$，然后通过在块中寻找碰撞（即找到使块内元素满足特定条件的组合），递归地构造出集合$S$。对这些方程求和，就能恢复出秘密向量$s$的第一个坐标（其他所有坐标的恢复方法与此类似）

略显意外的是，布鲁姆等人（Blum et al.）提出的算法是目前已知用于求解 LWE 问题的最优算法。这一现象与下述事实密切相关：目前已知用于求解格问题的最优算法 [AKS01, MV10]，其时间复杂度需达到$2^{O(n)}$。因此，对 LWE 问题求解算法的任何改进，都有可能为格问题算法带来突破性进展。

### 难度.

有多个理由可证明带误差学习（LWE）问题具有难度。首先，目前已知用于求解 LWE 问题的最优算法，其时间复杂度为指数级（即便量子算法，似乎也无法降低这一复杂度）。其次，LWE 问题是带噪声学习奇偶性（LPN）问题的自然扩展，而 LPN 问题本身是学习理论中已被广泛研究的问题，且普遍被认为具有难度。此外，LPN 问题可表述为随机线性二进制码的解码问题，因此，针对 LPN 问题的任何算法进展，都有可能为编码理论带来突破性成果。

第三点，也是最重要的一点，LWE 问题的难解性已被证明是基于对标准格问题（如 GAPSVP，即最短向量问题的判定版本；以及 SIVP，即最短独立向量问题）最坏情况难解性的特定假设 [Reg05, Pei09a]。更具体地说，当模数$q$为指数级时，LWE 的难解性基于一个标准假设 ——GAPSVP 问题难以在多项式因子内被近似求解。而对于多项式级模数q（这是密码学应用中更受关注的场景），其（难解性假设）则（需基于其他条件，原文此处未完整表述）。其难解性基于相对不那么标准（但仍极具可信度）的假设。具体而言，这两种假设分别为：一是即便提供了短基形式的 “提示”，GAPSVP（最短向量问题判定版）仍难以被近似求解；二是即便借助量子计算机，GAPSVP 或 SIVP（最短独立向量问题）仍难以在多项式因子内被近似求解。

我们注意到，在某种意义上，SIVP（最短独立向量问题）的难度高于 GAPSVP（最短向量问题判定版）；而我们拥有基于 SIVP 的难解性结论，这对于证明下文将介绍的环 LWE（ring-LWE）问题的难解性至关重要。我们还需注意，上述结论要求模数$q$需达到一定大小（通常至少为$\sqrt{n}$），因此这些结论不适用于 LPN（带噪声学习奇偶性）问题，即当\($q=2$\)的情况。最后，我们指出，针对最坏情况格问题所得到的近似因子通常具有$\tilde{O}(n/\alpha)$的形式，这也解释了为何我们倾向于要求$\alpha ≥1/poly(n)$（其中\(poly(n)\)表示n的多项式）。关于已知难解性结论的更多讨论，将在第 2 节中展开。

得益于这些强有力的难解性结论，对于质疑 LWE 问题难解性的研究者而言，他们可将该领域的相关研究视为寻找（可能基于量子的）最坏情况格问题求解算法的尝试（诚然，这也是 [Reg05] 一文最初的研究动机）。



### 变体. 

正如我们将在第 3 节中阐述的，带误差学习（LWE）问题可归约为多个表面上更简单的问题。这些归约是 LWE 问题能在密码学领域获得广泛应用的核心原因之一。在这些归约中，包括 “搜索到判定的归约” 与 “最坏情况到平均情况的归约”：前者表明，只需能区分 LWE 样本与完全均匀分布的样本即可（解决 LWE 问题）；后者则表明，只需针对均匀分布的秘密向量$s \in \mathbb{Z}_{q}^{n}$完成上述区分任务即可（推广到所有秘密向量的情况）。这两种归约过程都十分简洁，却具有极高的实用价值。此外，我们还将介绍近年来提出的一些相对复杂的归约方法。



### 密码学应用：

带误差学习（LWE）问题已被证明是构建密码方案的极具通用性的基础，部分原因在于其极强的灵活性 —— 上文所述的各类 LWE 变体便是这一灵活性的体现。具体而言，LWE 已被用于构建多种密码方案，例如：可抵抗选择明文攻击的公钥加密方案 [Reg05, KTX07, PVW08]、可抵抗选择密文攻击的公钥加密方案 [PW08, Pei09a]、不经意传输协议 [PVW08]、基于身份的加密（IBE）方案 [GPV08, CHKP10, ABB10]，以及各类抗泄漏加密方案（如 [AGV09, ACPS09, DGK⁺10, GKPV10]）等。此外，LWE 问题还被用于证明学习理论中的难解性结论 [KS06]。（需说明的是，带噪声学习奇偶性（LPN）问题 —— 即当模数\($q=2$\)时的特殊情况 —— 也存在密码学应用，但应用范围似乎远为有限，相关实例可参见文献 [BFKL93, HB01, Ale03, JW05, GRS08, ACPS09]。）

上述所有结果均依赖于带误差学习（LWE）问题；借助已知的难解性结论，我们可直接得到基于格问题最坏情况难解性的（密码方案）安全性保障。这使得基于 LWE 的密码学方案具备了大多数其他密码构造所不具备的强安全保证，例如被推测具有抗量子计算的安全性。此外，LWE 的吸引力还体现在其通常能实现高效的工程落地 —— 相关实现仅涉及低复杂度运算（往往以加法运算为主）。



### 起源. 

带误差学习（LWE）问题的起源可追溯至阿贾泰（Ajtai）与德沃克（Dwork）的经典研究 [AD97]—— 该研究提出了首个安全性基于格问题最坏情况难解性的公钥密码系统，同时也与后续对该系统的简化与改进工作 [GGH97, Reg03]（另见 [AD07]）密切相关。尽管 LWE 问题并未在上述任何一篇文献中直接出现，但仔细分析 [Reg03] 中给出的阿贾泰 - 德沃克构造（简化形式）可发现，其中已隐含了关于 LWE 问题难解性的结论。关于这一发现的更多细节，我们将在附录 A 中展开说明。

借此机会或许可以指出，该领域的早期研究（包括文献 [AD97, Reg03]）将（密码方案的）难解性建立在一个知名度不高的格问题之上，这个格问题被称为唯一最短向量问题（unique-SVP）；而且在很长一段时间里，人们都不确定能否用更标准的格问题来替代它。近年来，派克特（Peikert）[Pei09a] 以及柳巴谢夫斯基（Lyubashevsky）与米西亚尼西奥（Micciancio）[LM09] 发现，唯一最短向量问题（unique-SVP）本质上与标准格问题 —— 最短向量判定问题（GAPSVP）是等价的，这一发现使得该领域的理论框架变得清晰得多。本文的阐述也融入了这一研究结论。

### 小整数解（SIS）问题.

带误差学习（LWE）问题存在一个 “对偶” 问题，即小整数解问题（SIS，Small Integer Solution 的缩写）。在 SIS 问题中，给定一系列从$\mathbb{Z}_{q}^{n}$中均匀随机选取的向量$a_{1}, a_{2}, \dots$，要求找到其中一个子集（或更一般地，找到一组系数较小的线性组合），使得该子集（或线性组合）的和在模$q$意义下等于零。

从等价角度来看，SIS 问题也可理解为在随机格或随机码中寻找短向量的问题。SIS 问题由文献 [MR04] 首次提出，其思想源头可追溯至阿贾泰（Ajtai）具有开创性的研究 [Aj96]—— 在该研究中，研究者首次证明了存在基于格问题最坏情况难解性的密码学原语。

SIS 问题主要用于构建所谓 “基础密码学”（minicrypt）范畴的原语，例如单向函数 [Aj96]、抗碰撞哈希函数 [GGH96]、数字签名方案 [GPV08, CHKP10] 以及身份识别方案 [MV03, Lyu08, KTX08]。这与 LWE 问题形成鲜明对比：LWE 的密码学应用通常属于 “高级密码学”（cryptomania）范畴，即涵盖公钥加密及更复杂的密码方案。

SIS 问题的难解性已得到充分研究 [MR04]：目前已知，只要模数$q$至少是某个关于$n$的多项式），求解 SIS 问题的能力就意味着能够求解标准格问题（如最短独立向量问题 SIVP、最短向量判定问题 GAPSVP）的最坏情况实例。



### 环带误差学习（Ring-LWE）

基于小整数解（SIS）问题和带误差学习（LWE）问题构建的密码方案，往往需要较大的密钥规模，通常为$n^2$量级。这是因为在密码学应用中，这类方案通常需要提供至少$n$个向量$a_1, \dots, a_n \in \mathbb{Z}_q^n$，进而导致密钥规模达到$n^2$量级。

从实际应用角度来看，将密钥规模降至接近线性$O(n)$的水平是极具价值的；而且正如我们将在下文看到的，这一目标的实现或许还会推动该领域有趣的理论进展。

实现这一目标的一种自然方法（该方法与 NTRU 密码系统 [HPS98] 启发式设计所依据的思想相关），是假设带误差学习（LWE）或小整数解（SIS）问题的样本中存在某种结构。更具体地说，人们常考虑的一类 “结构” 如下：

假设$n$是 2 的幂次（原因稍后会解释），并假设向量$a$以包含$n$个样本的块为单位出现，即$a_1, \dots, a_n \in \mathbb{Z}_q^n$。其中，第一个向量$a_1=(a_1, \dots, a_n)$仍像之前一样均匀随机选取，其余向量则按如下方式定义：$a_i=(a_i, \dots, a_n, -a_1, \dots, -a_{i-1})（i \geq 2）$。

需要注意的是，此时表示$n$个向量仅需$\mathbb{Z}_q$中的$O(n)$个元素，而非原来的$O(n^2)$个元素。此外，借助快速傅里叶变换（FFT），对这类向量的运算速度可显著提升，进而能够引出这样的密码构造不仅拥有更小的密钥（规模），运算速度也显著更快。，

从数学角度而言，上述做法可理解为用环$\mathbb{Z}_{q}[x]/\langle x^n + 1 \rangle$替代群$\mathbb{Z}_{q}^n$。正是出于这个原因，这类结构化的变体被称为环小整数解问题（ring-SIS）和环带误差学习问题（ring-LWE）。尽管还存在其他环的选择，但为简便起见，本文在此仅聚焦于上述环。

要求$n$为 2 的幂次，目的是保证多项式$x^n + 1$在有理数域上是不可约的 —— 若不满足这一条件，某些情况会出现异常（例如，不难发现，在更为人熟知的 “循环环” $\mathbb{Z}_{q}[x]/\langle x^n - 1 \rangle$上，无论是 ring-SIS 问题，还是 ring-LWE 问题的判定版本，求解难度都很低，这一点可由因式分解式$x^n - 1 = (x - 1)(1 + x + \cdots + x^{n-1})$直接推导得出）。
