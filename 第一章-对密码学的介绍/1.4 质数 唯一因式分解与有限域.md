## 1.4 质数、唯一分解以及有限域

在1.3节中，我们学习了模算术，并了解到对整数进行模 $m$ 的加、减和乘法运算都是有意义的。然而，除法可能会存在问题，因为只有当$\gcd（a，m）=1$时，我们才能在$\mathbb{Z}/m\mathbb{Z}$中除以$a$。但需要注意的是，如果整数$m$是一个质数，那么我们就可以除以$\mathbb{Z}/m\mathbb{Z}$中的每一个非零元素。在回到$p$为质数的环$\mathbb{Z}/p\mathbb{Z}$之前，我们先简要讨论一下质数。

**Definition.** 如果一个整数 $p$ 满足 $p≥2$ ，且能整除$p$的正整数只有 $1$ 和 $p$ 本身，那么 $p$ 就被称为质数。

例如，前$10$个质数是$2、3、5、7、11、13、17、19、23、29$，而第$10$万个质数是$1299709$，第$100$万个质数是$15485863$。质数有无限多个，这一事实在古希腊就已为人所知，并作为定理出现在欧几里得的《几何原本》中（参见练习1.28）。

一个质数 $p$ 的定义取决于能整除 $p$ 的数。因此，下面这个描述能被 $p$ 整除的数的一个有用性质的命题并不明显，需要仔细证明。注意，这个命题对于合数来说是不成立的。例如，$6$ 能整除 $3·10$，但 $6$ 既不能整除 $3$，也不能整除 $10$ 。

**Proposition 1.19.** 设 $p$ 是一个质数，并且假设 $p$ 能整除两个整数 $a$ 和 $b$ 的乘积 $ab$。那么 $p$ 至少能整除 $a$ 和 $b$ 中的一个。更一般地说，如果 $p$ 能整除整数的一个乘积，比如
$$
p\mid a_1a_2\cdots a_n,
$$
那么 $p$ 至少能整除其中一个单独的 $a_i$。



Proof. 令$g=\gcd(a,p)$。那么$g$能整除$p$，因此 $g$ 要么等于 $1$ ，要么等于 $p$。如果 $g = p$，那么 $p$ 能整除 $a$（因为 $g$ 能整除 $a$），这样我们就完成了证明。否则，$g = 1$，且定理1.11告诉我们，我们可以找到整数 $u$ 和 $v$，使得 $au + pv = 1$ 。我们将等式两边同时乘以 $b$，得到
$$
\begin{array}{c}abu+pbv=b.\end{array}\tag{1.5}
$$
根据假设，$p$ 整除乘积 $ab$，并且显然 $p$ 整除 $pbv$，因此 $p$ 整除（1.5）式左侧的两项。由此可知，$p$ 整除右侧，这表明 $p$ 整除 $b$，从而完成了命题1.19的证明。

为了证明更具一般性的结论，我们将这个乘积写成 $a_1(a_2···a_n)$，并对 $a = a₁$ 和 $b = a_2···a_n$ 应用第一个结论。如果 $p$ 能整除$a_1$，那么我们就完成了证明。否则，$p$ 能整除 $a_2···a_n$，于是将其写成$a_2(a₃···a_n)$ ，第一个结论告诉我们，要么 $p$ 能整除 $a_2$ ，要么 $p$ 能整除 $a_3···a_n$ 。按照这种方式继续下去，我们最终必定能找到某个能被 $p$ 整除的 $a_i$。

作为命题1.19的一个应用，我们证明每个正整数都有一个本质上唯一的素数乘积分解式。



**Theorem 1.20** （算术基本定理）设 $a$ 是大于等于 $2$ 的整数，那么 $a$ 可以分解为素数的乘积。
$$
a=p_1^{e_1}\cdot p_2^{e_2}\cdot p_3^{e_3}\cdot\cdot\cdot p_r^{e_r}.
$$
此外，除了重新排列质数的顺序外，**这种分解为质数幂的方式是唯一的。**



Proof. 不难证明，每个$a\ge 2$ 都可以分解为素数的乘积。人们很容易认为这种分解的唯一性也是显而易见的。然而，事实并非如此；唯一分解性是整数的一个略显微妙的性质。我们将利用命题1.19的一般形式来证明这一点（关于唯一分解性不成立的情况示例，参见文献[137，第7章]中描述的E区）。

假设 $a$ 有两种分解方式，可分解为质数的乘积，
$$
a=p_1p_2\cdots p_s=q_1q_2\cdots q_t,\tag{1.6}
$$
其中 $p_i$ 和 $q_j$均为质数，它们不一定互不相同，且 $s$ 也不一定等于 $t$。由于 $p_1$ 能整除 $a$，我们可知 $p_1$ 能整除乘积 $q_1q_2q_3\cdots q_t$。因此，根据命题1.19的一般形式，我们发现 $p_1$ 能整除其中一个$q_i$。如果有必要，重新排列这些 $q_i$ 的顺序，我们可以假设 $p_1$ 整除 $q_1$。但 $p_1$ 和 $q_1$都是质数，所以我们必定有 $p_1 = q_1$。这使我们能够从（1.6）式的两边消去它们，从而得到
$$
p_2p_3\cdots p_s=q_2q_3\cdots q_t.
$$
重复这个过程 $s$ 次，我们最终会得到一个如下形式的方程
$$
\begin{array}{c}1=q_{t-s}q_{t-s+1}\cdots q_t.\end{array}
$$
由此立即可以得出 $t = s$，并且 $a$ 的原始因式分解除了因子的顺序可以重新排列外是完全相同的。（有关算术基本定理的更详细证明，请参见任何基础数论教科书，例如[35, 52, 59, 100, 111, 137]。）

>每个 $q_j$ 都是素数，所以都大于 $1$。
>
>如果乘积等于 $1$，说明**这个乘积里面没有素数**。
>
>如果 $s<t$，右边至少有一个素数，乘积 $≥ 2$，不可能 $=1$。
>
>如果 $s>t$，符号就不合逻辑（因为因子个数不能是负数）。
>
>唯一可能就是 $s=t$，此时乘积是空积（没有素数相乘），约定值就是 $1$。



**Definition.** 算术基本定理（定理1.20）表明，在将正整数 $a$ 分解为素数的过程中，每个素数 $p$ 都以特定的幂次出现。**我们用 $ord_p(a)$ 来表示这个幂次**，**并称之为 $p$ 在 $a$ 中的阶（或指数）**。（为方便起见，对于所有素数，我们规定 $ord_p(1)=0$。）

例如，$1728$的因式分解是$1728 = 2^6\cdot 3^3$，所以

$$
\mathrm{ord}_2(1728)=6,\mathrm{ord}_3(1728)=3,\mathrm{and}\ \mathrm{ord}_p(1728)=0\text{ for all primes }p\geq5.
$$
使用$\mathrm{ord}_p$符号，可以简洁地写出 $a$ 的因式分解
$$
a=\prod_{\mathrm{primes}\ p}p^{\mathrm{ord}_p(a)}
$$
请注意，这个乘积是有意义的，因为除了有限多个素数外，对于所有其他素数，$\mathrm{ord}_p(a)$ 都是零。将 $\mathrm{ord}_p$ 视为一个函数是很有用的。
$$
\mathrm{ord}_p:\{1,2,3,\ldots\}\longrightarrow\{0,1,2,3,\ldots\}.\tag{1.7}
$$
我们现在注意到，如果 $p$ 是一个质数，那么模 $p$ 的每个非零数都有一个模 $p$ 的乘法逆元。这意味着当我们进行模质数 $p$ 的运算时，我们不仅可以进行加法、减法、乘法运算，还可以对非零数进行除法运算，就像我们对实数进行运算时那样。质数的这一性质非常重要，因此我们将其正式表述为一个命题。



**Proposition 1.21. **设 $p$ 是一个素数。那么在 $\mathbb{Z}/p\mathbb{Z}$ 中，每个非零元素 $a$ 都有一个乘法逆元，即存在一个数 $b$ 满足
$$
ab\equiv1({\mathrm{mod}}\ p).
$$


我们将 $b$ 的这个值记为 $a^{-1}\mathrm{mod}\ p,$，或者如果 $p$ 已经被指定，那么就简单记为 $a^{-1}$。



Proof. 这个命题是命题1.13(b)在素数模 $p$ 情况下的特例，因为如果 $a$ 属于 $\mathbb{Z}/p\mathbb{Z}$ 且不为零，那么$\gcd(a,p)=1$。

Remark 1.22. 扩展欧几里得算法（定理1.11）为我们提供了一种计算 $a^{-1}\mathrm{mod}\ p,$ 的高效计算方法。我们只需解这个方程
$$
au+pv=1\quad\text{in integers}\ u\ \mathrm{and}\ v,
$$
然后 $u=a^{-1}\mathrm{mod}\ p$ 。关于计算 $u=a^{-1}\mathrm{mod}\ p$ 的另一种方法，参见 注1.26。

命题 1.21 **可以重述为：如果 $p$ 是素数，那么**
$$
(\mathbb{Z}/p\mathbb{Z})^*=\{1,2,3,4,\ldots,p-1\}.
$$
**换句话说，当从 $\mathbb{Z}/p\mathbb{Z}$ 中去掉 $0$ 元素后，剩下的元素都是单位元，并且在乘法运算下是封闭的。**



**Definition.** **如果 $p$ 是质数，那么配备了加法、减法、乘法和除法运算规则的整数模 $p$ 的集合 $\mathbb{Z}/p\mathbb{Z}$ 就是一个域的例子**。如果你学过抽象代数（或者参见2.10节），就会知道域是（交换）环的统称，**在这种环中，每个非零元素都有乘法逆元**。你已经熟悉其他一些域了，例如实数域 $\mathbb{R}$、有理数（分数）域$\mathbb{Q}$以及复数域$\mathbb{C}$。

**模 $p$ 整数域 $\mathbb{Z}/p\mathbb{Z}$ 只有有限多个元素。它是一个有限域，通常记为 $\mathbb{F}_q$**。因此，**$\mathbb{F}_q$ 和 $\mathbb{Z}/p\mathbb{Z}$ 实际上只是同一对象的两种不同记法**。类似地，**我们使用 $\mathbb{F}_q^*$ 来表示单位 $units$ $(\mathbb{Z}/p\mathbb{Z})^*$** 。有限域在整个密码学中，乃至在整个数学领域中都具有根本重要性。

Remark 1.23. 尽管 $\mathbb{Z}/p\mathbb{Z}$ 和 $\mathbb{F}_q$ 用于表示相同的概念，但在这两种情况下，元素的相等性表达方式略有不同。对于 $a,b\in\mathbb{F}_{p}$，$a$ 和 $ b$的相等性用 $a = b$ 表示，而对于 $a,b\in\mathbb{Z}/p\mathbb{Z},$，$a$ 和 $b$ 的相等性则用模 $p$ 等价来表示，即 $a\equiv b(\mathrm{mod}\ p).$。