## 1.5 有限域中的幂和原根

有限域在密码学中的应用通常涉及将 $\mathbb{F}_p$中的元素提升到高次幂。实际上，我们知道如何使用1.3.2节中描述的幂运算算法高效地完成这一操作。在本节中我们从纯数学的角度研究有限域 $\mathbb{F}_q$ 中的幂，证明了费马得出的一个基本结果，并阐述了单位群 $\mathbb{F}_q^*$ 的一个重要性质。

我们从一个简单的例子开始。表1.9列出了 $1,2,3,\ldots,6$ 对素数 $7$ 取模的幂。

![image-20251002191554461](https://raw.githubusercontent.com/hxd77/BlogImage/master/TyporaImage/20251002191554491.png)

表1.9中可以看到不少有趣的模式，其中特别值得注意的是，最右侧一列全是 $1$ 。我们可以这样重新表述这一观察结果：
$$
a^6\equiv1({\mathrm{mod}}7)\quad\text{for every }a=1,2,3,\ldots,6.
$$
当然，这并非对所有的 $a$ 值都成立，因为如果 $a$ 是 $7$ 的倍数，那么它的所有幂次也都是 $7$ 的倍数，在这种情况下，$a^{n}\equiv0({\mathrm{mod}}7).$。另一方面，如果 $a$ 不能被 $7$ 整除，那么 $a$ 模 $7$ 的结果就等同于 $1,2,3,\ldots,6$ 中的某一个值。因此
$$
a^6\equiv\begin{cases}1&({\mathrm{mod}}7)&\mathrm{if}\ 7\nmid a,\\0&\mathrm{(mod}7)&\mathrm{if}\ 7\mid a.&\end{cases}
$$
**Theorem 1.24.** (费马小定理). 设 $p$ 是一个质数，且设 $a$ 是任意整数。那么
$$
a^{p-1}\equiv\begin{cases}1&({\mathrm{mod}}p)\quad if\ p\nmid a,\\0&({\mathrm{mod}}p)\quad if\ p\mid a.&\end{cases}
$$
Proof. 费马小定理有许多证明方法。如果你学过群论，最快的证明是观察到 $\mathbb{F}_q$ 中的非零元素构成一个阶为 $p-1$ 的群 $\mathbb{F}_q^*$，因此根据拉格朗日定理，$\mathbb{F}_q^*$ 中的每个元素的阶都能整除 $p−1$ 。对于那些还没有修过群论课程的人，我们提供一个直接证明。

如果 $p\mid a$，那么显然 $a$ 的任何次幂都能被 $p$ 整除。因此，我们只需要考虑 $p\nmid a$ 的情况。现在我们来看这一系列数字。
$$
a,\quad2a,\quad3a,\quad\ldots,\quad(p-1)a\quad\text{reduced modulo}\ p.\tag{1.8}
$$
这个列表中有 $p−1$ 个数，我们断言它们都是不同的。要弄明白为什么，任取其中两个数，比如 $\text{ja mod p}$ 和 $\text{ka mod p}$，并假设它们是相同的。这意味着
$$
ja\equiv ka({\mathrm{mod}}p),\quad\text{and hence that}\quad(j-k)a\equiv0({\mathrm{mod}}p).
$$
因此，$p$ 整除乘积 $(j−k)a$ 。命题1.19告诉我们，要么 $p$ 整除 $j−k$ ，要么 $p$ 整除 $a$ 。然而，我们已经假设 $p$ 不整除 $a$，所以我们可以得出结论： $p$ 整除 $j−k$ 。但 $j$ 和 $ k$ 都在 $1$ 到 $p−1$ 之间，因此它们的差 $j−k$ 在 $−(p−2) $到 $p−2$ 之间。在 $−(p−2) $ 到 $p−2$ 之间，只有一个数能被 $p$ 整除，这个数就是 $0$ ！这证明了 $j−k=0$ ，也就是说 $ja=ka$ 。因此，我们已经证明了列表（1.8）中的$p−1 $ 个数都是不同的。它们也都是非零的，因为 $1,2,3,\ldots,p-1$ 和 $a$ 都不能被 $p$ 整除。

概括来说，我们已经证明了数列（1.8）由 $p−1$ 个介于 $1$ 到 $ p−1$ 之间的不同数字组成。但介于 $1$ 到 $p−1$ 之间的不同数字只有 $p−1$ 个，因此数列（1.8）必定只是数字 $1,2,3,\ldots,p-1$ 以某种打乱的顺序排列而成的数列。



**Proposition 1.29.** 设 $p$ 为一个素数，$a$ 为一个不能被 $p$ 整除的整数。假设 $a^{n}\equiv1({\mathrm{mod}}p)$，那么 $a$ 模 $p$ 的阶能整除 $n$ 。特别地，$a$ 的阶能整除 $p-1$。

**Theorem 1.30** （原根定理）。设 $p$ 是一个素数。那么存在一个元素 $g\in\mathbb{F}_{p}^{*}$，其幂能生成 $\mathbb{F}_{p}^{*}$ 中的每一个元素，即
$$
\mathbb{F}_p^*=\{1,g,g^2,g^3,\ldots,g^{p-2}\}.
$$
**具有这种性质的元素被称为 $\mathbb{F}_{p}$ 的原根或 $\mathbb{F}_{p}^{*}$ 的生成元** 。它们是 $\mathbb{F}_{p}^{*}$ 中阶为 $p-1$ 的元素。

Example 1.31. 域 $\mathbb{F}_{11}$ 具有 $2$ 作为原根，因为在 $\mathbb{F}_{11}$ 中，
$$
2^{0}=1，2^{1}=2，2^{2}=4，2^{3}=8，
2^{4}=5，\\ 2^{5}=10， 2^{6}=9，2^{7}=7，2^{8}=3，2^{9}=6。
$$
因此，$\mathbb{F}_{11}$ 的所有 $10$ 个非零元素都被生成为 $2$ 的幂。另一方面，$ 2$ 不是 $\mathbb{F}_{17}$ 的原根，因为在 $\mathbb{F}_{17}$ 中，
$$
2^{0}=1，2^{1}=2，2^{2}=4，2^{3}=8，
2^{4}=16，\\ 2^{5}=15， 2^{6}=13，2^{7}=9，2^{8}=1
$$
所以在得到模 $17 $ 的所有 $16$ 个非零值之前，我们就回到了 $1$ 。不过，事实证明 $3$ 是 $17$ 的一个原根，因为在 $\mathbb{F}_{17}$ 中，
$$
3^{0}=1，3^{1}=3，3^{2}=9，3^{3}=10，
3^{4}=13， 3^{5}=5， \\ 3^{6}=15，3^{7}=11，3^{8}=16，3^{9}=14。 
3^{10}=8，3^{11}=7，\\ 3^{12}=4，3^{13}=12。3^{14}=2，3^{15}=6
$$


Remark 1.32. 如果 $p$ 很大，那么有限域 $\mathbb{F}_{p}$ 有相当多的原根。精确的公式表明，$\mathbb{F}_{p}$ 恰好有 $\phi(p-1)$ 个原根，其中 $\phi$ 是欧拉函数（见第22页）。例如，你可以验证以下是$ \mathbb{F}_{29}$ 的所有原根的完整列表：
$$
\{2,3,8,10,11,14,15,18,19,21,26,27\}.
$$
这与 $\phi(28)=12$ 的值一致。更一般地说，如果 $k$ 能整除 $p−1$ ，那么在 $\mathbb{F}_p^*$ 中恰好有 $\phi{(k)}$ 个元素的阶为 $k$。